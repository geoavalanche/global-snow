<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>OpenLayers: WMS + Time</title>
    <link rel="stylesheet" href="theme/default/style.css" type="text/css">
    <link rel="stylesheet" href="style.css" type="text/css">
    <script src="OpenLayers.js"></script>
    <script type="text/javascript">
        var map, sno_wms;
		
		function get_date() {
		    return OpenLayers.Util.getElement('year').value + "-" +
                         OpenLayers.Util.getElement('month').value + "-" +
                         OpenLayers.Util.getElement('day').value + "T00:00:00";       
		}
		
		function get_date2() {
		    return new Date(OpenLayers.Util.getElement('year').value,
                         OpenLayers.Util.getElement('month').value,
                         OpenLayers.Util.getElement('day').value, 0, 0, 0);     
		}
		
        function init(){
            map = new OpenLayers.Map('map');

            var ol_wms = new OpenLayers.Layer.WMS( "OpenLayers WMS",
                "http://vmap0.tiles.osgeo.org/wms/vmap0?", {layers: 'basic'} );

            var jpl_wms = new OpenLayers.Layer.WMS( "NASA Global Mosaic",
                "http://t1.hypercube.telascience.org/cgi-bin/landsat7", 
                {layers: "landsat7"});

            sno_wms = new OpenLayers.Layer.WMS("Snow sites","http://snow.hydrodata.org/mapserver.cgi?",
			{layers:"snow_daily",transparent:true, format:'image/png', time:get_date()});

            jpl_wms.setVisibility(false);

            map.addLayers([ol_wms, sno_wms]);
            map.addControl(new OpenLayers.Control.LayerSwitcher());
            map.zoomToExtent(new OpenLayers.Bounds(-100.898437,22.148438,-78.398437,39.726563));
        }
		
        function update_date() {
            var string = OpenLayers.Util.getElement('year').value + "-" +
                         OpenLayers.Util.getElement('month').value + "-" +
                         OpenLayers.Util.getElement('day').value + "T00:00:00";                       
            sno_wms.mergeNewParams({'time':string});
        }
		
		function move_day() {
		    var dat = get_date2();
			dat.setDate(dat.getDate() + 1);
			var string = dat.toISOString();
			OpenLayers.Util.getElement('year').value = string.substr(0, 4);
			OpenLayers.Util.getElement('month').value = string.substr(5,2);
			OpenLayers.Util.getElement('day').value = string.substr(8,2);
			update_date();
		}
		
    </script>
  </head>
  <body onload="init()">
     <h1 id="title">Snow observations WMS Time Example</h1>
        <div id="tags">
            wmst, wms-t
        </div>
        <p id="shortdesc">
            Shows the use of the layer WMS-T (time) layer</a>
        </p>
    <input size="4" type='text' id='year' value="2014" />-<input size="2" type="text" id="month" value="01" />-<input size="2" type="text" id="day" value="29"  />
	<input type='submit' id='next' value="-->" onclick="move_day()"/>
    <div id="map" class="smallmap"></div>
    <div id="docs">
        <p>WMS-T example: update the times, and the snow report locations change.
        Uses Layer.mergeNewParams to update the date element with the strings
        from the input fields every time one of them is changed. The inputs
        above describe a daily timestamp.</p>
    </div>
  </body>
</html>



